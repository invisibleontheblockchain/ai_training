{
  "source_file": "defi_test_results_20250621_004856.json",
  "analysis_timestamp": "2025-06-21T01:15:58.301999",
  "language_analysis": {
    "language_distribution": {
      "python": 5,
      "mixed": 1
    },
    "examples_by_language": {
      "python": [
        {
          "prompt": "Create a basic price oracle contract that stores and retrieves asset prices with proper access contr...",
          "response": "```python\nfrom typing import Dict, Any\n\nclass PriceOracle:\n    def __init__(self):\n        self.prices: Dict[str, float] = {}\n    \n    def set_price(self, asset: str, price: float) -> None:\n        se...",
          "test_id": "level_1_task_0_1750484907",
          "confidence": 0.9807692307692307
        },
        {
          "prompt": "Create a lending pool contract with reentrancy protection and proper collateral management...",
          "response": "```python\nfrom typing import Dict, Optional\nimport sqlite3\n\nclass LendingPool:\n    def __init__(self):\n        self.conn = sqlite3.connect('lending_pool.db')\n        self.cursor = self.conn.cursor()\n ...",
          "test_id": "level_2_task_0_1750484920",
          "confidence": 0.9821428571428571
        },
        {
          "prompt": "Implement a simple DEX with MEV protection and slippage controls...",
          "response": "```python\nimport time\n\nclass SimpleDEX:\n    def __init__(self):\n        self.trades = []\n    \n    def trade(self, buyer, seller, amount, price):\n        if buyer.balance < amount * price or seller.bal...",
          "test_id": "level_2_task_1_1750484926",
          "confidence": 0.9787234042553191
        }
      ],
      "mixed": [
        {
          "prompt": "Implement an ERC20 token with mint and burn functionality...",
          "response": "```python\nfrom typing import Dict\n\nclass ERC20Token:\n    def __init__(self, name: str, symbol: str):\n        self.name = name\n        self.symbol = symbol\n        self.balance_of: Dict[str, int] = {}\n...",
          "test_id": "level_1_task_1_1750484911",
          "confidence": 0.13333333333333333
        }
      ]
    },
    "total_tests": 6,
    "primary_issue": {
      "issue": "python_default",
      "severity": "critical",
      "description": "Model generates Python in 83.3% of cases",
      "hypothesis": "Model has learned 'code generation = Python' association",
      "urgency": "IMMEDIATE - This breaks all smart contract generation"
    }
  },
  "error_patterns": {
    "categories": {
      "compilation_failure": [
        {
          "test_id": "level_1_task_0_1750484907",
          "prompt_snippet": "Create a basic price oracle contract that stores a...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_1_task_1_1750484911",
          "prompt_snippet": "Implement an ERC20 token with mint and burn functi...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_2_task_0_1750484920",
          "prompt_snippet": "Create a lending pool contract with reentrancy pro...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_2_task_1_1750484926",
          "prompt_snippet": "Implement a simple DEX with MEV protection and sli...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_3_task_0_1750484930",
          "prompt_snippet": "Create an oracle contract and DEX that uses the or...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_3_task_1_1750484935",
          "prompt_snippet": "Build a lending protocol with automated liquidatio...",
          "error": "Could not extract contract name"
        }
      ],
      "security_issues": [
        {
          "test_id": "level_1_task_0_1750484907",
          "prompt_snippet": "Create a basic price oracle contract that stores a...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_1_task_1_1750484911",
          "prompt_snippet": "Implement an ERC20 token with mint and burn functi...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_2_task_0_1750484920",
          "prompt_snippet": "Create a lending pool contract with reentrancy pro...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_2_task_1_1750484926",
          "prompt_snippet": "Implement a simple DEX with MEV protection and sli...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_3_task_0_1750484930",
          "prompt_snippet": "Create an oracle contract and DEX that uses the or...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_3_task_1_1750484935",
          "prompt_snippet": "Build a lending protocol with automated liquidatio...",
          "error": "Could not extract contract name"
        }
      ],
      "gas_efficiency": [
        {
          "test_id": "level_1_task_0_1750484907",
          "prompt_snippet": "Create a basic price oracle contract that stores a...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_1_task_1_1750484911",
          "prompt_snippet": "Implement an ERC20 token with mint and burn functi...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_2_task_0_1750484920",
          "prompt_snippet": "Create a lending pool contract with reentrancy pro...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_2_task_1_1750484926",
          "prompt_snippet": "Implement a simple DEX with MEV protection and sli...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_3_task_0_1750484930",
          "prompt_snippet": "Create an oracle contract and DEX that uses the or...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_3_task_1_1750484935",
          "prompt_snippet": "Build a lending protocol with automated liquidatio...",
          "error": "Could not extract contract name"
        }
      ],
      "integration_failure": [
        {
          "test_id": "level_1_task_0_1750484907",
          "prompt_snippet": "Create a basic price oracle contract that stores a...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_1_task_1_1750484911",
          "prompt_snippet": "Implement an ERC20 token with mint and burn functi...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_2_task_0_1750484920",
          "prompt_snippet": "Create a lending pool contract with reentrancy pro...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_2_task_1_1750484926",
          "prompt_snippet": "Implement a simple DEX with MEV protection and sli...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_3_task_0_1750484930",
          "prompt_snippet": "Create an oracle contract and DEX that uses the or...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_3_task_1_1750484935",
          "prompt_snippet": "Build a lending protocol with automated liquidatio...",
          "error": "Could not extract contract name"
        }
      ],
      "language_mismatch": [
        {
          "test_id": "level_1_task_0_1750484907",
          "prompt_snippet": "Create a basic price oracle contract that stores a...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_2_task_0_1750484920",
          "prompt_snippet": "Create a lending pool contract with reentrancy pro...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_2_task_1_1750484926",
          "prompt_snippet": "Implement a simple DEX with MEV protection and sli...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_3_task_0_1750484930",
          "prompt_snippet": "Create an oracle contract and DEX that uses the or...",
          "error": "Could not extract contract name"
        },
        {
          "test_id": "level_3_task_1_1750484935",
          "prompt_snippet": "Build a lending protocol with automated liquidatio...",
          "error": "Could not extract contract name"
        }
      ]
    },
    "top_patterns": [
      [
        "no_contract_detected",
        6
      ]
    ],
    "total_errors": 29,
    "critical_patterns": [
      "no_contract_detected"
    ]
  },
  "prompt_response_mapping": {
    "feature_analysis": {
      "has_technical_spec": 0.0,
      "mentions_defi": 0.0,
      "has_implementation_verb": 0.0,
      "starts_with_verb": 0.0
    },
    "best_prompt_features": [],
    "worst_prompt_features": [
      {
        "feature": "has_technical_spec",
        "frequency": 0.6
      },
      {
        "feature": "mentions_defi",
        "frequency": 1.0
      },
      {
        "feature": "has_implementation_verb",
        "frequency": 1.0
      },
      {
        "feature": "starts_with_verb",
        "frequency": 1.0
      }
    ],
    "prompt_optimization_suggestions": [
      "Start prompts with 'Create a Solidity contract that...'",
      "Add '// SPDX-License-Identifier: MIT' to expected outputs",
      "Include 'pragma solidity ^0.8.0;' in examples",
      "Use 'smart contract' instead of just 'contract' for clarity"
    ]
  },
  "systematic_failures": {
    "systematic_patterns": [
      {
        "pattern": "python|compilation_failure|gas_efficiency|integration_failure|language_mismatch|security_issues",
        "frequency": 5,
        "examples": [
          "level_1_task_0_1750484907",
          "level_2_task_0_1750484920",
          "level_2_task_1_1750484926"
        ],
        "severity": 10,
        "description": "Model consistently generates Python code when Solidity is requested"
      }
    ],
    "total_unique_failures": 2,
    "most_common_failure": {
      "pattern": "python|compilation_failure|gas_efficiency|integration_failure|language_mismatch|security_issues",
      "frequency": 5,
      "examples": [
        "level_1_task_0_1750484907",
        "level_2_task_0_1750484920",
        "level_2_task_1_1750484926"
      ],
      "severity": 10,
      "description": "Model consistently generates Python code when Solidity is requested"
    },
    "critical_patterns": [
      {
        "pattern": "python|compilation_failure|gas_efficiency|integration_failure|language_mismatch|security_issues",
        "frequency": 5,
        "examples": [
          "level_1_task_0_1750484907",
          "level_2_task_0_1750484920",
          "level_2_task_1_1750484926"
        ],
        "severity": 10,
        "description": "Model consistently generates Python code when Solidity is requested"
      }
    ]
  },
  "model_confusion_analysis": {
    "confusion_distribution": {
      "language_mixing": 1,
      "wrong_syntax_right_concepts": 4,
      "complete_language_swap": 0,
      "no_code_generated": 0,
      "hallucinated_syntax": 0
    },
    "examples": {
      "wrong_syntax_right_concepts": [
        {
          "prompt": "Create a basic price oracle contract that stores and retrieves asset prices with proper access contr...",
          "response": "```python\nfrom typing import Dict, Any\n\nclass PriceOracle:\n    def __init__(self):\n        self.prices: Dict[str, float] = {}\n    \n    def set_price(s...",
          "test_id": "level_1_task_0_1750484907"
        },
        {
          "prompt": "Implement a simple DEX with MEV protection and slippage controls...",
          "response": "```python\nimport time\n\nclass SimpleDEX:\n    def __init__(self):\n        self.trades = []\n    \n    def trade(self, buyer, seller, amount, price):\n     ...",
          "test_id": "level_2_task_1_1750484926"
        }
      ],
      "language_mixing": [
        {
          "prompt": "Implement an ERC20 token with mint and burn functionality...",
          "response": "```python\nfrom typing import Dict\n\nclass ERC20Token:\n    def __init__(self, name: str, symbol: str):\n        self.name = name\n        self.symbol = sy...",
          "test_id": "level_1_task_1_1750484911"
        }
      ]
    },
    "primary_confusion": "wrong_syntax_right_concepts",
    "confusion_analysis": {
      "cause": "concept_syntax_disconnect",
      "confidence": "high",
      "description": "Model understands DeFi concepts but applies Python syntax",
      "fix_priority": "HIGH"
    }
  },
  "defi_specific_analysis": {
    "concept_breakdown": {
      "oracle": {
        "total_tests": 3,
        "solidity_generation": 0,
        "python_generation": 3,
        "solidity_rate": 0.0,
        "python_rate": 1.0
      },
      "dex": {
        "total_tests": 2,
        "solidity_generation": 0,
        "python_generation": 2,
        "solidity_rate": 0.0,
        "python_rate": 1.0
      },
      "lending": {
        "total_tests": 2,
        "solidity_generation": 0,
        "python_generation": 2,
        "solidity_rate": 0.0,
        "python_rate": 1.0
      },
      "token": {
        "total_tests": 2,
        "solidity_generation": 0,
        "python_generation": 1,
        "solidity_rate": 0.0,
        "python_rate": 0.5
      },
      "erc20": {
        "total_tests": 1,
        "solidity_generation": 0,
        "python_generation": 0,
        "solidity_rate": 0.0,
        "python_rate": 0.0
      }
    },
    "most_problematic_concept": "oracle",
    "defi_specific_recommendations": [
      "Critical: ORACLE prompts generate Python 100% of time - need immediate Solidity examples",
      "Critical: DEX prompts generate Python 100% of time - need immediate Solidity examples",
      "Critical: LENDING prompts generate Python 100% of time - need immediate Solidity examples",
      "Create DeFi-specific Solidity templates for each concept",
      "Use working smart contract examples in few-shot prompting",
      "Add explicit 'Create a Solidity smart contract' prefix to all DeFi prompts",
      "Include pragma solidity statement in all expected outputs"
    ]
  },
  "recommendations": [
    {
      "priority": "CRITICAL",
      "action": "Break Python Association - EMERGENCY FIX",
      "steps": [
        "IMMEDIATE: Inject 100+ working Solidity contract examples",
        "Add explicit 'Language: Solidity' to ALL prompts",
        "Use few-shot prompting with 3-5 Solidity examples per prompt",
        "Add negative examples: 'This should NOT be Python code'",
        "Implement pre-generation language priming: 'Generate Solidity smart contract code:'"
      ],
      "expected_impact": "Should see 50%+ improvement in 5-10 iterations",
      "urgency": "FIX TODAY - System completely broken for smart contracts"
    },
    {
      "priority": "HIGH",
      "action": "Address Critical Pattern: Model consistently generates Python code when Solidity is requested",
      "steps": [
        "This pattern occurs in 5 tests (severity: 10/10)",
        "Create targeted training examples for this specific failure",
        "Implement pattern-specific prompt engineering",
        "Add validation to prevent this pattern recurring",
        "Focus on test IDs: level_1_task_0_1750484907, level_2_task_0_1750484920, level_2_task_1_1750484926"
      ],
      "expected_impact": "Eliminate 5 recurring failures"
    },
    {
      "priority": "HIGH",
      "action": "Fix ORACLE Concept Generation",
      "steps": [
        "oracle prompts have severe Python generation issues",
        "Create oracle-specific Solidity templates",
        "Add working oracle smart contract examples to training",
        "Use concept-specific prompt prefixes for oracle",
        "Test oracle generation separately until fixed"
      ],
      "expected_impact": "Fix oracle smart contract generation"
    }
  ]
}