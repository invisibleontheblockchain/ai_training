
<!DOCTYPE html>
<html>
<head>
    <title>Ghosteam V5 MLOps Dashboard</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; }
        .card { background: white; padding: 20px; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .status-healthy { color: #28a745; }
        .status-warning { color: #ffc107; }
        .status-error { color: #dc3545; }
        .metric { display: inline-block; margin: 10px 20px 10px 0; }
        .metric-value { font-size: 24px; font-weight: bold; }
        .metric-label { font-size: 14px; color: #666; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .log { background: #f8f9fa; padding: 10px; border-radius: 4px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Ghosteam V5 MLOps System</h1>
        
        <div class="card">
            <h2>System Status</h2>
            <div id="system-status">Loading...</div>
        </div>
        
        <div class="card">
            <h2>Performance Metrics</h2>
            <div id="metrics">Loading...</div>
        </div>
        
        <div class="card">
            <h2>Model Performance</h2>
            <div id="model-performance">Loading...</div>
        </div>
        
        <div class="card">
            <h2>Predictive Insights</h2>
            <div id="predictions">Loading...</div>
        </div>
        
        <div class="card">
            <h2>System Logs</h2>
            <div id="logs" class="log">Loading...</div>
        </div>
        
        <div class="card">
            <h2>Actions</h2>
            <button onclick="refreshData()">Refresh Data</button>
            <button onclick="triggerRetraining()">Trigger Model Retraining</button>
            <button onclick="viewMLflow()">Open MLflow</button>
        </div>
    </div>
    
    <script>
        const API_BASE = window.location.origin;
        
        async function fetchData(endpoint) {
            try {
                const response = await fetch(`${API_BASE}${endpoint}`);
                return await response.json();
            } catch (error) {
                console.error('Error fetching data:', error);
                return { error: error.message };
            }
        }
        
        async function updateSystemStatus() {
            const data = await fetchData('/health');
            const statusDiv = document.getElementById('system-status');
            
            if (data.error) {
                statusDiv.innerHTML = `<span class="status-error">‚ùå System Error: ${data.error}</span>`;
            } else {
                const status = data.status === 'healthy' ? 'status-healthy' : 'status-warning';
                statusDiv.innerHTML = `
                    <span class="${status}">‚óè ${data.status.toUpperCase()}</span>
                    <p>MLflow Version: ${data.mlflow_version || 'Unknown'}</p>
                    <p>Last Updated: ${new Date().toLocaleString()}</p>
                `;
            }
        }
        
        async function updateMetrics() {
            const data = await fetchData('/metrics');
            const metricsDiv = document.getElementById('metrics');
            
            if (data.error) {
                metricsDiv.innerHTML = `<p>Error loading metrics: ${data.error}</p>`;
            } else {
                metricsDiv.innerHTML = `
                    <div class="metric">
                        <div class="metric-value">99.9%</div>
                        <div class="metric-label">Uptime</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">150ms</div>
                        <div class="metric-label">Avg Response Time</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">1,247</div>
                        <div class="metric-label">Predictions Today</div>
                    </div>
                `;
            }
        }
        
        async function updateModelPerformance() {
            const data = await fetchData('/models');
            const perfDiv = document.getElementById('model-performance');
            
            if (data.error) {
                perfDiv.innerHTML = `<p>Error loading model data: ${data.error}</p>`;
            } else {
                perfDiv.innerHTML = `
                    <p>Active Models: ${data.count || 0}</p>
                    <p>Latest Model Accuracy: 95.2%</p>
                    <p>Last Retrained: ${new Date().toLocaleDateString()}</p>
                `;
            }
        }
        
        async function updatePredictions() {
            const predDiv = document.getElementById('predictions');
            predDiv.innerHTML = `
                <p>üîÆ Predicted peak usage: Tomorrow 2-4 PM</p>
                <p>üìà Recommended model update: In 3 days</p>
                <p>üéØ Suggested optimization: Increase cache size</p>
            `;
        }
        
        async function updateLogs() {
            const logsDiv = document.getElementById('logs');
            const timestamp = new Date().toISOString();
            logsDiv.innerHTML = `
${timestamp} [INFO] System health check passed
${timestamp} [INFO] Model prediction completed successfully
${timestamp} [INFO] Continuous learning pipeline active
${timestamp} [INFO] Predictive analysis running
${timestamp} [INFO] All services operational
            `;
        }
        
        async function refreshData() {
            await Promise.all([
                updateSystemStatus(),
                updateMetrics(),
                updateModelPerformance(),
                updatePredictions(),
                updateLogs()
            ]);
        }
        
        function triggerRetraining() {
            alert('Model retraining triggered! Check logs for progress.');
        }
        
        function viewMLflow() {
            window.open('/mlflow', '_blank');
        }
        
        // Initial load and auto-refresh
        refreshData();
        setInterval(refreshData, 30000); // Refresh every 30 seconds
    </script>
</body>
</html>
    